# ğŸŒ HKEX é¦™æ¸¯è¯åˆäº¤æ˜“æ‰€çˆ¬èŸ²ç³»çµ±

## ğŸ“Œ é …ç›®æ¦‚è¿°

æœ¬é …ç›®æ˜¯ä¸€å€‹å°ˆæ¥­çš„é¦™æ¸¯è¯åˆäº¤æ˜“æ‰€ (Hong Kong Exchanges and Clearing, HKEX) ç¶²é çˆ¬èŸ²ç³»çµ±ï¼Œæ¡ç”¨ **TypeScript + Playwright + Crawlee** æŠ€è¡“æ£§ï¼Œå°ˆé–€ç”¨æ–¼çˆ¬å–å’Œè§£æ HKEX å®˜æ–¹ç¶²ç«™çš„å¸‚å ´æ•¸æ“šã€‚

### ğŸ¯ æ ¸å¿ƒåŠŸèƒ½

#### **1ï¸âƒ£ å¸‚å ´æ•¸æ“šçˆ¬èŸ²** (Market Data Crawler)
- **çˆ¬èŸ²æ–‡ä»¶**: `src/main_hkex_multi_month.ts`
- **åŠŸèƒ½**: æå– HKEX æ¯æ—¥å¸‚å ´çµ±è¨ˆæ•¸æ“š
- **æ—¥æœŸç¯„åœ**: 2025å¹´ 9æœˆ + 10æœˆ (45 å€‹äº¤æ˜“æ—¥)
- **è¼¸å‡º**: `data/hkex_all_market_data.csv`

**æå–çš„ 10 å€‹å¸‚å ´æŒ‡æ¨™**:
1. æˆäº¤è‚¡ä»½ (Shares Traded)
2. æˆäº¤è‚¡æ•¸ (Number of Shares Traded)
3. è‚¡ä»½ä½”æ¯” (Percentage)
4. ä¸Šå‡è‚¡æ•¸ (Advanced Stocks)
5. ä¸‹è·Œè‚¡æ•¸ (Declined Stocks)
6. æ¼²è·Œä¸è®Š (Unchanged Stocks)
7. æ’æŒ‡ - æˆäº¤è‚¡ä»½ (HSI Shares)
8. æ’æŒ‡ - æˆäº¤è‚¡æ•¸ (HSI Shares Count)
9. æ’ç”Ÿåœ‹ä¼æŒ‡æ•¸ - æˆäº¤è‚¡ä»½ (HSCEI Shares)
10. æ’ç”Ÿåœ‹ä¼æŒ‡æ•¸ - æˆäº¤è‚¡æ•¸ (HSCEI Shares Count)

---

#### **2ï¸âƒ£ åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²** (Top Stocks Crawler)
- **çˆ¬èŸ²æ–‡ä»¶**: `src/main_top_stocks.ts`
- **åŠŸèƒ½**: æå–æ¯æ—¥åå¤§æˆäº¤è‚¡ç¥¨æ’å
- **æ—¥æœŸç¯„åœ**: 2025å¹´ 9æœˆ + 10æœˆ (45 å€‹äº¤æ˜“æ—¥)
- **è¼¸å‡º**: 90 å€‹ CSV æª”æ¡ˆ (å–®æ—¥ + åˆä½µ)

**æå–çš„å…©å€‹è¡¨æ ¼**:

1. **åå¤§æˆäº¤è‚¡æ•¸æœ€å¤š** (Top 10 Most Active by Shares)
   - å–®æ—¥è¼¸å‡º: `data/top_stocks/top_stocks_by_shares_2025-MM-DD.csv`
   - åˆä½µæª”æ¡ˆ: `top_stocks_by_shares_all.csv`
   - æ•¸æ“šé‡: 330 è¡Œ

2. **åå¤§æˆäº¤é‡‘é¡æœ€å¤š** (Top 10 Most Active by Turnover)
   - å–®æ—¥è¼¸å‡º: `data/top_stocks/top_stocks_by_turnover_2025-MM-DD.csv`
   - åˆä½µæª”æ¡ˆ: `top_stocks_by_turnover_all.csv`
   - æ•¸æ“šé‡: 136 è¡Œ

**CSV æ¬„ä½**:
```
Date, Rank, Code, Ticker, Product, Name_CHI, Currency,
Shares_Traded, Turnover_HKD, High, Low
```

---

## ğŸ› ï¸ æŠ€è¡“æ¶æ§‹

### æ ¸å¿ƒæŠ€è¡“æ£§

| æŠ€è¡“ | ç”¨é€” | ç‰ˆæœ¬ |
|------|------|------|
| **TypeScript** | é¡å‹å®‰å…¨èªè¨€ | ~5.9.0 |
| **Playwright** | ç€è¦½å™¨è‡ªå‹•åŒ– | * |
| **Crawlee** | çˆ¬èŸ²æ¡†æ¶ | ^3.0.0 |
| **Node.js** | é‹è¡Œæ™‚ç’°å¢ƒ | 14+ |

### æ–‡ä»¶çµæ§‹

```
hkexçˆ¬èŸ²/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main_hkex_multi_month.ts    â­ å¸‚å ´æ•¸æ“šçˆ¬èŸ²
â”‚   â”œâ”€â”€ main_top_stocks.ts           â­ åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²
â”‚   â””â”€â”€ [å…¶ä»–è¼”åŠ©å·¥å…·]
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ hkex_all_market_data.csv     ğŸ“Š å¸‚å ´æ•¸æ“š
â”‚   â””â”€â”€ top_stocks/                  ğŸ“Š åå¤§è‚¡ç¥¨æ•¸æ“š
â”œâ”€â”€ package.json                     ğŸ“¦ ä¾è³´é…ç½®
â””â”€â”€ README.md                        ğŸ“– æœ¬æ–‡ä»¶
```

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### 1. å®‰è£ä¾è³´

```bash
cd hkexçˆ¬èŸ²
npm install
```

### 2. åŸ·è¡Œçˆ¬èŸ²

#### å¸‚å ´æ•¸æ“šçˆ¬èŸ²
```bash
npm run start:hkex
```
- æ™‚é–“: ~2-3 åˆ†é˜
- è¼¸å‡º: `data/hkex_all_market_data.csv`

#### åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²
```bash
npm run start:top-stocks
```
- æ™‚é–“: ~2-3 åˆ†é˜
- è¼¸å‡º: `data/top_stocks/` (92 å€‹æª”æ¡ˆ)

### 3. æŸ¥çœ‹æ•¸æ“š

```bash
# å¸‚å ´æ•¸æ“š
head -5 data/hkex_all_market_data.csv

# åå¤§æˆäº¤è‚¡ä»½
head -5 data/top_stocks/top_stocks_by_shares_all.csv

# åå¤§æˆäº¤é‡‘é¡
head -5 data/top_stocks/top_stocks_by_turnover_all.csv
```

---

## ğŸ’¡ å¯¦ç¾åŸç†

### REGEX æ¨¡å¼åŒ¹é…æ¼”ç®—æ³•

çˆ¬èŸ²æ¡ç”¨å…©å±¤ REGEX æ¨¡å¼ç²¾ç¢ºæå–æ•¸æ“šï¼š

#### **ç¬¬ 1 å±¤ï¼šè¡¨æ ¼å®šä½**
```regex
/10 MOST ACTIVES \(SHARES\)([\s\S]*?)(?=---|$)/
```

#### **ç¬¬ 2 å±¤ï¼šè¡Œæ•¸æ“šæå–**
```regex
/(\d+)\s+([A-Z#]+)\s+([A-Z0-9]+)\s+(.+?)\s+(HKD|USD)\s+([\d,]+)\s+([\d,]+)\s+([\d.]+)\s+([\d.]+)/g
```

**æ•ç²çµ„èªªæ˜**:
| çµ„è™Ÿ | å…§å®¹ | ç¤ºä¾‹ |
|------|------|------|
| 1 | è‚¡ç¥¨ä»£ç¢¼ | 69273 |
| 2 | è‚¡ç¥¨ç°¡ç¨± | JP#HSI |
| 3 | ç”¢å“ä»£ç¢¼ | RP2808W |
| 4 | ä¸­æ–‡åç¨± | æ’æŒ‡æ‘©é€šå…«å…«ç†Šï¼· |
| 5 | è²¨å¹£ | HKD |
| 6 | æˆäº¤è‚¡æ•¸ | 14088020000 |
| 7 | æˆäº¤é‡‘é¡ | 559698590 |
| 8 | æœ€é«˜åƒ¹ | 0.052 |
| 9 | æœ€ä½åƒ¹ | 0.023 |

---

## ğŸ“ˆ åŸ·è¡Œæ•ˆèƒ½

### å¸‚å ´æ•¸æ“šçˆ¬èŸ²
```
âœ… ç¸½è«‹æ±‚: 45  |  æˆåŠŸ: 45 (100%)  |  è€—æ™‚: 137.4 ç§’
å¹³å‡æ™‚é–“/è«‹æ±‚: 5.68 ç§’
```

### åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²
```
âœ… ç¸½è«‹æ±‚: 45  |  æˆåŠŸ: 45 (100%)
ğŸ“Š æˆäº¤è‚¡ä»½è¡¨: 330 è¡Œ  |  æˆäº¤é‡‘é¡è¡¨: 136 è¡Œ
ğŸ—‚ï¸ è¼¸å‡ºæª”æ¡ˆ: 92 å€‹ CSV
```

---

## ğŸŒ HKEX ç¶²ç«™çµæ§‹

### URL æ¨¡å¼
```
https://www.hkex.com.hk/chi/stat/smstat/dayquot/d{YY}{MM}{DD}c.htm
```

### ä¾‹å­
```
2025å¹´9æœˆ2æ—¥:
https://www.hkex.com.hk/chi/stat/smstat/dayquot/d250902c.htm
```

### é é¢ç‰¹æ€§
- **ç·¨ç¢¼**: Big5 (ç¹é«”ä¸­æ–‡)
- **æ›´æ–°**: æ¯å€‹äº¤æ˜“æ—¥
- **å…§å®¹**: å¸‚å ´çµ±è¨ˆ + åå¤§æˆäº¤è‚¡ç¥¨

---

## ğŸ” æ•¸æ“šé©—è­‰

âœ… **ä¸­æ–‡å­—ç¬¦æ”¯æŒ**:
- è‚¡ç¥¨åç¨±: ç›ˆå¯ŒåŸºé‡‘, æ’æŒ‡æ‘©é€šå…«å…«ç†Šï¼·
- ç‰¹æ®Šç¬¦è™Ÿ: âœ“ æ­£ç¢ºè§£æ

âœ… **æ•¸æ“šå®Œæ•´æ€§**:
- è‚¡ç¥¨ä»£ç¢¼: 4-5 ä½æ•¸å­—
- äº¤æ˜“æ•¸æ“š: å®Œæ•´ä¿ç•™
- åƒ¹æ ¼æ•¸æ“š: å°æ•¸é»ä¿ç•™

---

## ğŸ“š æ–‡ä»¶åƒè€ƒ

| æª”æ¡ˆ | èªªæ˜ |
|------|------|
| `src/main_hkex_multi_month.ts` | å¸‚å ´æ•¸æ“šçˆ¬èŸ²ä¸»ç¨‹å¼ |
| `src/main_top_stocks.ts` | åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²ä¸»ç¨‹å¼ |
| `package.json` | NPM ä¾è³´å’Œ NPM è…³æœ¬ |
| `tsconfig.json` | TypeScript ç·¨è­¯é…ç½® |

---

## âš™ï¸ çˆ¬èŸ²é…ç½®

### Crawlee PlaywrightCrawler é…ç½®
```typescript
maxRequestsPerCrawl: undefined        // ç„¡ä¸Šé™
maxRequestRetries: 1                  // å¤±æ•—é‡è©¦ 1 æ¬¡
navigationTimeoutSecs: 30             // å°èˆªè¶…æ™‚
maxCrawlDepth: 1                      // çˆ¬å–æ·±åº¦
maxRequestsPerMinute: 20              // é€Ÿç‡é™åˆ¶
```

---

## ğŸ“ ç‰ˆæœ¬æ—¥èªŒ

### v1.0 (2025-10-20) âœ… å®Œæˆ

- âœ… å¸‚å ´æ•¸æ“šçˆ¬èŸ²å®Œæˆ (45 äº¤æ˜“æ—¥)
- âœ… åå¤§æˆäº¤è‚¡ç¥¨çˆ¬èŸ²å®Œæˆ (å…©è¡¨)
- âœ… ä¸­æ–‡å­—ç¬¦å®Œå…¨æ”¯æŒ
- âœ… REGEX æ¨¡å¼å„ªåŒ–
- âœ… CSV è¼¸å‡ºç”Ÿæˆ

---

## ğŸ“ å­¸ç¿’é‡é»

æœ¬é …ç›®å±•ç¤ºæŠ€è¡“ï¼š
1. Web Scraping (Playwright è‡ªå‹•åŒ–)
2. REGEX æ¨¡å¼åŒ¹é…èˆ‡æ–‡æœ¬è§£æ
3. çµæ§‹åŒ–æ•¸æ“šæå–
4. CSV æª”æ¡ˆç”Ÿæˆèˆ‡è™•ç†
5. è²¬ä»»çˆ¬èŸ²é€Ÿç‡é™åˆ¶
6. TypeScript é¡å‹å®‰å…¨é–‹ç™¼
7. ç•°å¸¸è™•ç†èˆ‡éŒ¯èª¤é‡è©¦

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼** ğŸš€
